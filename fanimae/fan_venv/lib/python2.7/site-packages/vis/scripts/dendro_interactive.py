import matplotlib.pyplot as plt
from scipy.cluster.hierarchy import dendrogram, linkage

graph_settings = {
                  'label_connections': True,
                  'connection_string': 'r.',
                  'linkage_type': 'average',
                  'xlabel': 'Interval Analyses: Josquin = 1-12; Lassus = 13-24; Morley = 25-36',
                  'ylabel': 'Percent Dissimilarity',
                  'title': 'Josquin Lassus and Morley Duet Intervallic Dissimilarity',
                  'interactive_dendrogram': False,
                  'filename_and_type': None, # VIS_PATH[:-3] + '36_JLM_Duets_Interval_Dendrogram.pdf', # .pdf and .png (default) are the only possible formats
                  'return_data': True
                  }
dendrogram_settings = {
                           'p': 40,
                           'truncate_mode': None,
                           'color_threshold': 0,
                           'get_leaves': True,
                           'orientation': 'top',
                           'labels': None,
                           'count_sort': False,
                           'distance_sort': False,
                           'show_leaf_counts': True,
                           'no_plot': False,
                           'no_labels': False,
                           'color_list': None,
                           'leaf_font_size': None,
                           'leaf_rotation': -90,
                           'leaf_label_func': None,
                           'no_leaves': False,
                           'show_contracted': False,
                           'link_color_func': None,
                           'ax': None,
                           'above_threshold_color': 'k'
                           }



plt.figure('Dendrogram') 
matrix = [24.252837654899515, 14.63252411040904, 39.573159703382174, 38.144329896907223, 34.312971226342512, 35.642302791613581, 45.276322460706439, 34.70790378006874, 
    39.687994327169598, 27.053600909858012, 29.058754505070826, 35.562886597938146, 42.704492437354205, 32.538127289767417, 
    33.181491249100937, 28.01086869655559, 31.703092783505159, 34.144639950391451, 32.134239964904573, 26.34909349448986, 37.89600421401159, 36.389559113840761, 29.355105726540753, 
    42.054254358876918, 45.626169037365706, 55.029111692751464, 49.165795109318189, 28.409900707872115, 44.664462166893607, 48.993618065783018, 49.740583518630821, 51.271166674441382, 
    22.913829994164558, 32.094043009749498, 37.692978406934394, 22.743564679048557, 28.86762360446571, 24.877642403415599, 20.78998944670586, 21.84769038701624, 45.736049014737532, 
    19.23583662714098, 27.176527176527177, 14.608720658542707, 18.625277161862531, 26.804040404040407, 31.24677431246775, 22.865013774104682, 23.279304674653524, 24.547803617571063, 
    25.624242424242439, 25.244930508088402, 18.181818181818187, 23.782654127481706, 28.555629285556293, 31.377605845690958, 21.138391211383922, 28.329376716473487, 31.901291394962293, 
    41.304234050348029, 36.758893280632407, 21.561234464460288, 33.169430150562242, 37.518037518037517, 33.57100415923945, 39.791580968051555, 20.926243567753012, 24.438959733077393, 
    20.578923563998185, 42.218449349179402, 38.920297084580433, 37.297384047504408, 36.039627884499239, 45.91926670192138, 35.483870967741936, 41.372247823860739, 29.082003596984652, 
    28.402832415420921, 33.892473118279575, 40.930853151244015, 28.890073758108947, 31.907976994248564, 25.781445361340328, 32.464516129032262, 33.35758751718005, 31.57172271791352, 
    25.546903967371147, 34.746095282944822, 34.179821551132463, 31.057216858959269, 48.694316436251917, 52.266231114740712, 61.669173770126463, 53.311516284868318, 30.261136712749625, 
    51.304524244268613, 54.070660522273428, 52.076744676365159, 55.471220746363059, 23.875025360113622, 34.544835303848586, 40.009629272989891, 32.754566829444762, 25.216025137470545, 
    32.958801498127357, 65.602530917457585, 32.265446224256301, 21.553884711779446, 27.545732659049762, 22.935387248609317, 32.884210526315783, 29.414777820463577, 31.129476584022054, 
    33.578131374949017, 34.924520603835163, 38.638596491228071, 25.062656641604008, 32.213512504665907, 30.102843315184515, 27.263414009476239, 32.848077640910802, 38.647714175950831, 
    29.266715175034353, 27.026426826560069, 31.788019270975365, 22.37477752351894, 27.51232921012209, 23.085071168487261, 26.14870509607352, 25.799793601651189, 23.402397396205444, 
    36.610393909301564, 40.985949035484651, 28.62005760670332, 14.986921064779201, 19.819298042395474, 44.532702382964338, 14.896160167339023, 35.831560573828639, 16.340756502916697, 
    20.585030592573972, 22.177319587628862, 24.539092482504334, 23.830621112720461, 21.777351554383461, 27.459442180132676, 24.964948453608258, 24.796527400976675, 15.690575418585961, 
    28.716672591539293, 23.861840620061713, 27.805805366673987, 22.529911957257898, 21.825264858188042, 22.571664709208751, 33.919128251695966, 32.865182529010397, 29.098769537745262, 
    27.461583349542906, 29.280532373315882, 30.051883296273839, 37.794467509446285, 23.707449912468405, 33.022344544479175, 22.695799353746736, 21.465705181955396, 50.183508686077815, 
    13.367942894224527, 27.821211403300961, 12.933552876188459, 15.107389879868949, 16.597014925373145, 16.668482405490803, 19.045269520167764, 17.748466967488142, 22.688881175517761, 
    22.889552238805965, 18.291998653349793, 15.761617444691433, 22.336592897581063, 18.291752914260819, 22.186937652164719, 23.564658459527188, 20.290253800123804, 20.4672838339946, 
    28.984610625628328, 20.059124666522454, 25.909622394937749, 20.749084764854974, 17.128642501776824, 24.982928494781, 24.238535827649088, 16.800901154604343, 27.79766326737354, 
    17.910447761194025, 51.722232455332474, 25.175052922976725, 38.231971939837109, 19.73289615738334, 30.757285100940891, 29.950561797752819, 31.985565488394986, 29.362057758380544, 
    24.736521208953921, 30.938071596550831, 30.175280898876402, 29.475373827828012, 20.200812813770021, 34.258039519566054, 30.14024440252604, 32.966770260578549, 28.680390387927488, 
    24.983171956713115, 28.492864931493855, 36.572160447109489, 33.810997123161258, 24.382540257857411, 32.656349374602513, 34.938469769930435, 31.423955349930242, 37.409120951751483, 
    28.908204367182535, 29.467690274035284, 19.173793951590355, 46.614397719173205, 61.063405325700401, 41.817863601890203, 46.261495401839255, 37.849180327868858, 44.932392006700972, 
    35.713317978593686, 38.378447070784084, 38.378447070784091, 33.088524590163935, 40.675459139652403, 40.169747703755377, 36.630864895421148, 42.922101232499699, 39.681432391582369, 
    28.873997846117028, 57.694341618191423, 61.859306910147339, 70.831563747557965, 68.836619941395426, 55.186220442698499, 60.822765233529232, 62.763466042154569, 69.206043072966892, 
    71.619316074475179, 36.894525208784415, 48.089904309769302, 58.143707691052938, 30.112721417069256, 16.411367270101618, 16.366207140332268, 15.67536231884058, 17.899079657251672, 
    19.942508084800579, 13.784967981125718, 19.986518368722617, 16.417391304347827, 18.502778685845055, 11.563367252543944, 20.729635182408799, 18.618428012271238, 20.752389762565528, 
    18.53379879403364, 19.187871502037002, 19.372592184920201, 29.27085679957948, 25.60386473429951, 28.143992519869098, 22.816516270166808, 28.479411088106744, 25.916453537936913, 
    29.811790937110626, 21.263330598851525, 22.867073250704973, 13.67077655202249, 30.10600839782337, 23.048135243257207, 35.826455026455029, 35.445873402077801, 30.696576151121601, 
    35.154423526516553, 34.428448381936761, 38.484656084656088, 29.546087440824287, 34.808060339975242, 28.943623426382047, 30.135557872784158, 34.605426094787795, 36.175800409377054, 
    31.148660180918252, 32.013930748107988, 40.814759985744445, 31.285944329422588, 34.254992319508446, 32.840171708096257, 35.449735449735456, 31.963896669779025, 31.379731379731378, 
    31.728062294100045, 32.854509325097567, 24.299139224512377, 17.203367763214985, 14.16654804270463, 22.393952775540939, 16.411282021117035, 18.345333664376938, 21.622665452840074, 
    19.866192170818497, 17.670510796564365, 13.719996971303082, 18.517609522640811, 19.248253110631996, 21.458317558870288, 15.2791126581292, 23.13823244830018, 26.427616859618308, 
    35.533715634392337, 30.524180377189801, 19.197402299227573, 26.511784059625331, 29.706829350957463, 31.302770218407648, 34.666108436257062, 16.277445779896592, 25.046295550796284, 
    20.566208105380568, 20.806504065040642, 24.129131802266922, 16.629711751662956, 18.491208167895635, 23.615050103989411, 25.079674796747952, 13.564398801882749, 19.079743988929231, 
    12.79506588169329, 18.71699008960892, 24.044282996021437, 22.289478369236239, 27.717208047656506, 30.842852732324786, 39.445637979695846, 32.473194297160354, 24.843580233037343, 
    28.2896149716214, 27.680991095625242, 36.170891120675904, 34.492145826435639, 20.25157232704402, 33.804215870212992, 25.154714233709498, 10.843795620437946, 13.157024793388439, 
    10.040310077519376, 14.914728682170553, 12.0, 10.279699248120311, 14.371631205673751, 15.144827586206899, 9.4656934306569305, 13.032624113475178, 14.983941605839412, 
    26.812903225806451, 29.171308016877639, 38.810362694300515, 32.104347826086951, 30.263594470046083, 25.675471698113217, 29.663492063492058, 35.299346405228761, 35.370135746606337, 
    20.8301886792453, 28.948416289592771, 27.136318407960193, 18.133558544971951, 13.161319526962034, 20.415322808804394, 16.595620437956203, 13.588716316338301, 16.757260444168352, 
    21.10747545935061, 12.408759124087588, 15.028213490707653, 22.627737226277368, 25.755995828988532, 25.085466136930613, 33.149275746000527, 24.880990161853379, 37.051363988025166, 
    22.019005646605152, 24.836828486463524, 29.931778064023661, 30.894738580440606, 25.594270761603088, 32.10687980975657, 26.589679340523652, 10.705362290985976, 15.670446537254145, 
    14.459504132231405, 10.402038153234328, 13.041439540472432, 11.758335708178979, 10.418049104180493, 10.831721470019351, 12.746576582011215, 32.650340861484558, 37.371412630330923, 
    47.043206440286042, 35.832634646863895, 31.964809384164226, 35.387494152502732, 34.212252394070589, 41.203478636633704, 38.412923974421311, 19.089349758303452, 32.769903892898547, 
    30.319476995189344, 12.403100775193799, 8.0682170542635596, 10.368945619863613, 9.1703777008081744, 15.626837743918731, 11.378939625417306, 12.765957446808507, 14.027046907712325, 
    27.703354410031089, 32.185261505249741, 40.012852954171187, 34.715200539265247, 33.422641374629379, 28.922041831212532, 32.86575612157008, 37.513299893600852, 37.980988459784641, 
    19.698698259470525, 29.239889157809817, 24.968182344093481, 10.232558139534875, 17.351518330710491, 13.904007916872828, 13.573910719059068, 13.297119900413056, 13.046346693056243, 
    16.901488145759068, 33.904904797627985, 37.768619370032383, 48.005783829377023, 38.591169531513302, 37.84517557960919, 36.559894690653792, 39.067306509166976, 43.714850281197748, 
    41.856957452032695, 13.119789381307589, 25.227121259953002, 31.667245169501324, 15.609022556390983, 11.080851063829778, 13.406896551724124, 14.055474452554739, 12.885106382978728, 
    11.363503649635032, 30.289400921658981, 34.771308016877647, 43.3740932642487, 39.304347826086946, 36.663594470046093, 32.422641509433973, 37.557671957671957, 40.156862745098046, 
    42.57013574660634, 17.494339622641508, 25.183710407239822, 28.051741293532327, 15.144243587692641, 11.433756805807626, 8.9896273530541855, 13.581826907694762, 16.60172328631797, 
    29.056512248362843, 33.514165159734787, 42.116950407105847, 33.471359558316074, 30.802813485326208, 29.218328840970354, 31.523252575884165, 38.842203548085898, 34.419759806756709, 
    23.152220173074191, 34.025108018916072, 28.189877679272801, 17.246270481780389, 13.982502458973956, 17.730496453900702, 12.149919759797069, 22.920547766120858, 27.641619534967234, 
    37.103590195862267, 33.148319457292615, 27.773964767787685, 29.126187608724752, 32.241359900934377, 34.000834376303715, 36.414107377812009, 17.505687140372007, 25.332948236577778, 
    20.948449243145973, 12.987666750566317, 15.690877965272687, 14.704253712559778, 35.334498649292868, 39.129928706532816, 47.732713953903868, 39.223721472597028, 31.422215159701249, 
    35.627846454131429, 35.821930304688934, 44.457967094883919, 39.397721953502895, 17.111255692908266, 30.20440006241223, 32.410361983187506, 9.8151886938965589, 18.978102189781019, 
    27.36385347640352, 31.845760571622172, 40.754888241745768, 31.802954970203455, 35.813515422651285, 29.387136758022315, 32.394855752519987, 37.173798959973283, 31.796413118869115, 
    21.691227103704737, 30.501700961125611, 28.049533355122193, 13.837552414971267, 28.09425760695494, 32.60615854205944, 42.068129202954466, 32.356871209785176, 38.167140569336865, 
    34.154957848253709, 37.813801643588882, 37.727715199554993, 34.995667661499951, 20.661046433828446, 28.866210968839255, 30.094209802053552, 30.014463991388883, 34.45748252179002, 
    43.674596270942843, 40.939384322437313, 29.782367385381281, 35.777441123812146, 39.910400494342099, 41.791899241448405, 44.205172242956706, 18.914750034430526, 26.135350265878397, 
    29.2697098449359, 11.162962530867803, 16.162460304195225, 18.473251853336002, 30.414746543778804, 21.96504651769412, 30.653695169824204, 19.318695220023496, 18.658381466730624, 
    31.602469350491269, 15.968471755948045, 16.372056766856957, 12.911829649548533, 15.098147128967165, 28.666705555231488, 18.584507602897858, 25.403522871877303, 12.807148175725979, 
    21.307062260152353, 35.946182628771609, 26.173702197529458, 15.750362113483218, 15.896973792896297, 32.790525536639528, 22.142926972333555, 25.281684349041853, 18.561414202986892, 
    17.424331231097455, 45.785511780232667, 30.152627013340215, 23.906374861444068, 31.144949798526234, 17.125148117765011, 17.414308718656546, 13.839158851946575, 11.303473451811064, 
    34.819068453194781, 28.797516777056419, 19.316461172398881, 28.510564298756623, 30.96091483188258, 28.0503599289178, 35.473444961110999, 32.059820885140425, 33.82196551077007, 
    20.404888002384382, 11.474493361285809, 19.457393020101133, 27.649620080252713, 34.716981132075475, 33.834201314778454, 21.05697925467004, 25.73918456271398, 25.698484522013931, 
    33.027852650494161, 42.699130934425057, 26.65245202558636, 18.501759678230268, 40.189912442964605, 28.808446455505287, 14.808311384255202, 37.59583368906344, 26.244343891402721, 
    24.411877265257431, 20.029027576197389, 28.245564629681784, 20.879764075549858]
print len(matrix)
d_data = dendrogram(matrix, **dendrogram_settings)

# Add connection annotations if the user asked for them
if graph_settings['label_connections']:
    for i, d in zip(d_data['icoord'], d_data['dcoord']):
        x = 0.5 * sum(i[1:3])
        y = d[1]
        plt.plot(x, y, graph_settings['connection_string'])
        plt.annotate("%.3g" % y, (x, y), xytext=(0, -8), textcoords='offset points',
                     va='top', ha='center')
# Apply labels. If you want to omit a label, pass an empty string ''.
plt.xlabel(graph_settings['xlabel'])
plt.ylabel(graph_settings['ylabel'])
plt.title(graph_settings['title'])
# If the user provided a filepath, export as a .png (default) or .pdf.
if graph_settings['filename_and_type'] is not None:
    plt.savefig(graph_settings['filename_and_type'])
# If the user wants an interactive matplotlib dendrogram, make it.
if graph_settings['interactive_dendrogram']:
    plt.show()

plt.show()